"0","simulate_DDM <- function(v = 2, a = 1, z = 0, ter = .3,"
"0","                         sv = 1, sz = .3,"
"0","                         s = 1, dt = .001, tmax = 5, ntrials = 10){"
"0","  "
"0","  # Initialize variables"
"0","  tmax_step <- tmax/dt # and also the max time in steps rather than absolute time"
"0","  rts <- rep(NA, ntrials) "
"0","  resps <- rep(NA, ntrials)"
"0","  "
"0","    # Trial loop"
"0","    for (trial in 1:ntrials) {"
"0","      "
"0","      trial_v <- rnorm(1, v, sv)"
"0","      trial_z <- runif(1, z - sz/2, z + sz/2)"
"0","  "
"0","      tstep <- 1 # you will need count time steps rather than absolute time (to be able to use this as an index for the evidence vector)"
"0","      x <- rep(NA, tmax_step) # a vector to store the evidence at each time step in"
"0","      x[1] <- trial_z # set the initial evidence to the starting point (zero in this case)"
"0","    "
"0","      while (tstep < tmax_step){"
"0","        x[tstep+1] <- x[tstep] + trial_v*dt + s*sqrt(dt)*rnorm(1, 0, 1)"
"0","        if (x[tstep] >= a) {"
"0","          resps[trial] <- 1"
"0","          break"
"0","        } else if (x[tstep] <= -a) {"
"0","          resps[trial] <- 0"
"0","          break"
"0","        }"
"0","        tstep <- tstep + 1"
"0","      }"
"0","      rts[trial] <- tstep*dt + ter"
"0","    }"
"0","  data <- data.frame(rt = rts, resp = resps)"
"0","  return(data)"
"0","}"
"0","simulate_DDM()"
